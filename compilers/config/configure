#!/bin/sh

#######################################################################
#                                                                     #
#                           Simport                                   #
#                                                                     #
#          Pierre Weis, INRIA Rocquencourt                            #
#                                                                     #
#  Copyright 2010-2013,                                               #
#  Institut National de Recherche en Informatique et en Automatique.  #
#  All rights reserved.                                               #
#                                                                     #
#  This file is distributed under the terms of the BSD License.       #
#                                                                     #
#######################################################################

# $Id: configure 6237 2013-10-24 22:48:46Z weis $

######################################
# set_value x val 
# set x value to va if x has no value 
######################################

set_value () {
  ok=false
  eval \$$1 2> /dev/null || ok=true;
  if test $ok = "false"; then 
    eval $1='$2';
  fi 
}

test_set_value () {
    ok=true
    x=10;
    set_value x 20;
    set_value y 20;
    echo result $x $y
    if test "$x" != 10 -o "$y" != 20; then
	echo "test failed" 
    fi
}
# test_set_value 

##################################
# default values computed here 
# if variables are not already set
##################################

set_value COMPILERS_SRC_INSTALL_DIR  "\$(ROOT_DIR)/scilab"

# generate Config.mk

GENERATED=Config.mk

rm -f $GENERATED

echo "# -*- mode : Makefile -*-"  > $GENERATED 
echo "#" >> $GENERATED
echo "# Warning: this file has been generated." >> $GENERATED
echo "#" >> $GENERATED
echo "# DO NOT EDIT THIS FILE!" >> $GENERATED
echo "#" >> $GENERATED
echo "# The editable source of this file is in $GENERATED.in" >> $GENERATED
echo "#" >> $GENERATED

sed \
    -e "s|@COMPILERS_SRC_INSTALL_DIR@|$COMPILERS_SRC_INSTALL_DIR|" \
$GENERATED.in >> $GENERATED

chmod -w $GENERATED

